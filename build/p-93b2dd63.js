(()=>{const t={},n="stencil.sudoku.worker",r=n+".cb",e=t=>{if(t){if(t instanceof ArrayBuffer)return[t];if(t.constructor===Object)return[].concat(...Object.keys(t).map((n=>e(t[n]))));if("object"==typeof t)return e(t.buffer)}return[]};addEventListener("message",(async({data:i})=>{if(i&&i[0]===n){let u,o,s=i[1],c=i[2],f=i[3],a=0,h=f.length;try{for(;a<h;a++)if(Array.isArray(f[a])&&f[a][0]===r){const t=f[a][1];f[a]=(...n)=>{postMessage([r,t,n])}}u=await t[c](...f)}catch(t){u=null,o=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},u=void 0}const l=e(u);postMessage([n,s,u,o],l)}}));class i{static getHorizontalRowByRowIndex(t,n){const r=9*n;return t.slice(r,r+9)}static getVerticalRowByRowIndex(t,n){return t.filter(((t,r)=>r%9===n))}static getSubgridBySubgridIndex(t,n){return t.filter((t=>t.subgrid===n))}static getHorizontalNeighboursByCellIndex(t,n){const r=Math.floor(n/9),e=i.getHorizontalRowByRowIndex(t,r);return i.getNeighbours(t,e,n)}static getVerticalNeighboursByCellIndex(t,n){const r=Math.floor(n%9),e=i.getVerticalRowByRowIndex(t,r);return i.getNeighbours(t,e,n)}static getSubgridNeighboursByCellIndex(t,n){const r=i.getSubgridBySubgridIndex(t,t[n].subgrid);return i.getNeighbours(t,r,n)}static getNeighbours(t,n,r){return t[r].value&&(n=n.filter((n=>n.value!==t[r].value))),n.filter((t=>!!t.value))}}var u,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s="object"==typeof self&&self&&self.Object===Object&&self,c="object"==typeof o&&o&&o.Object===Object&&o||s||Function("return this")(),f=c.Symbol,a=Object.prototype,h=a.hasOwnProperty,l=a.toString,v=f?f.toStringTag:void 0,d=Object.prototype.toString,b=f?f.toStringTag:void 0,y=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":b&&b in Object(t)?function(t){var n=h.call(t,v),r=t[v];try{t[v]=void 0;var e=!0}catch(t){}var i=l.call(t);return e&&(n?t[v]=r:delete t[v]),i}(t):function(t){return d.call(t)}(t)},g=function(t){var n=typeof t;return null!=t&&("object"==n||"function"==n)},p=function(t){if(!g(t))return!1;var n=y(t);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n},j=c["__core-js_shared__"],w=(u=/[^.]+$/.exec(j&&j.keys&&j.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"",_=Function.prototype.toString,m=/^\[object .+?Constructor\]$/,O=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),x=function(t){return!(!g(t)||(n=t,w&&w in n))&&(p(t)?O:m).test(function(t){if(null!=t){try{return _.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var n},I=function(t,n){var r=function(t,n){return null==t?void 0:t[n]}(t,n);return x(r)?r:void 0},B=I(Object,"create"),A=Object.prototype.hasOwnProperty,M=Object.prototype.hasOwnProperty;function N(t){var n=-1,r=null==t?0:t.length;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}N.prototype.clear=function(){this.__data__=B?B(null):{},this.size=0},N.prototype.delete=function(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n},N.prototype.get=function(t){var n=this.__data__;if(B){var r=n[t];return"__lodash_hash_undefined__"===r?void 0:r}return A.call(n,t)?n[t]:void 0},N.prototype.has=function(t){var n=this.__data__;return B?void 0!==n[t]:M.call(n,t)},N.prototype.set=function(t,n){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=B&&void 0===n?"__lodash_hash_undefined__":n,this};var S=N,C=function(t,n){for(var r=t.length;r--;)if((e=t[r][0])===(i=n)||e!=e&&i!=i)return r;var e,i;return-1},E=Array.prototype.splice;function F(t){var n=-1,r=null==t?0:t.length;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}F.prototype.clear=function(){this.__data__=[],this.size=0},F.prototype.delete=function(t){var n=this.__data__,r=C(n,t);return!(r<0||(r==n.length-1?n.pop():E.call(n,r,1),--this.size,0))},F.prototype.get=function(t){var n=this.__data__,r=C(n,t);return r<0?void 0:n[r][1]},F.prototype.has=function(t){return C(this.__data__,t)>-1},F.prototype.set=function(t,n){var r=this.__data__,e=C(r,t);return e<0?(++this.size,r.push([t,n])):r[e][1]=n,this};var P=F,$=I(c,"Map"),R=function(t,n){var r,e,i=t.__data__;return("string"==(e=typeof(r=n))||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==r:null===r)?i["string"==typeof n?"string":"hash"]:i.map};function k(t){var n=-1,r=null==t?0:t.length;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}k.prototype.clear=function(){this.size=0,this.__data__={hash:new S,map:new($||P),string:new S}},k.prototype.delete=function(t){var n=R(this,t).delete(t);return this.size-=n?1:0,n},k.prototype.get=function(t){return R(this,t).get(t)},k.prototype.has=function(t){return R(this,t).has(t)},k.prototype.set=function(t,n){var r=R(this,t),e=r.size;return r.set(t,n),this.size+=r.size==e?0:1,this};var T=k;function V(t){var n=-1,r=null==t?0:t.length;for(this.__data__=new T;++n<r;)this.add(t[n])}V.prototype.add=V.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},V.prototype.has=function(t){return this.__data__.has(t)};var D,z,H,U,G=V,L=function(t){return t!=t},X=function(t,n){return!(null==t||!t.length)&&function(t,n,r){return n==n?function(t,n,r){for(var e=r-1,i=t.length;++e<i;)if(t[e]===n)return e;return-1}(t,n,r):function(t,n,r,e){for(var i=t.length,u=r+(e?1:-1);e?u--:++u<i;)if(n(t[u],u,t))return u;return-1}(t,L,r)}(t,n,0)>-1},q=function(t,n,r){for(var e=-1,i=null==t?0:t.length;++e<i;)if(r(n,t[e]))return!0;return!1},J=function(t,n){return t.has(n)},K=I(c,"Set"),Q=function(t){var n=-1,r=Array(t.size);return t.forEach((function(t){r[++n]=t})),r},W=K&&1/Q(new K([,-0]))[1]==1/0?function(t){return new K(t)}:function(){},Y=function(t){return t&&t.length?function(t,n,r){var e=-1,i=X,u=t.length,o=!0,s=[],c=s;if(r)o=!1,i=q;else if(u>=200){var f=n?null:W(t);if(f)return Q(f);o=!1,i=J,c=new G}else c=n?[]:s;t:for(;++e<u;){var a=t[e],h=n?n(a):a;if(a=r||0!==a?a:0,o&&h==h){for(var l=c.length;l--;)if(c[l]===h)continue t;n&&c.push(h),s.push(a)}else i(c,h,r)||(c!==s&&c.push(h),s.push(a))}return s}(t):[]},Z=function(t,n,r,e){var i,u=-1,o=X,s=!0,c=t.length,f=[],a=n.length;if(!c)return f;r&&(n=function(t,n){for(var r=-1,e=null==t?0:t.length,i=Array(e);++r<e;)i[r]=n(t[r],r,t);return i}(n,(i=r,function(t){return i(t)}))),e?(o=q,s=!1):n.length>=200&&(o=J,s=!1,n=new G(n));t:for(;++u<c;){var h=t[u],l=null==r?h:r(h);if(h=e||0!==h?h:0,s&&l==l){for(var v=a;v--;)if(n[v]===l)continue t;f.push(h)}else o(n,l,e)||f.push(h)}return f},tt=function(t){return t},nt=function(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)},rt=Math.max,et=function(){try{var t=I(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),it=Date.now,ut=(D=et?function(t,n){return et(t,"toString",{configurable:!0,enumerable:!1,value:(r=n,function(){return r}),writable:!0});var r}:tt,z=0,H=0,function(){var t=it(),n=16-(t-H);if(H=t,n>0){if(++z>=800)return arguments[0]}else z=0;return D.apply(void 0,arguments)}),ot=function(t){return function(t){return null!=t&&"object"==typeof t}(t)&&function(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}(t.length)&&!p(t)}(t)},st=function(t){return ut(function(t,n,r){return n=rt(void 0===n?t.length-1:n,0),function(){for(var e=arguments,i=-1,u=rt(e.length-n,0),o=Array(u);++i<u;)o[i]=e[n+i];i=-1;for(var s=Array(n+1);++i<n;)s[i]=e[i];return s[n]=r(o),nt(t,this,s)}}(t,void 0,tt),t+"")}((function(t,n){return ot(t)?Z(t,n):[]}));!function(t){t[t.PREVIOUS=0]="PREVIOUS",t[t.NEXT=1]="NEXT"}(U||(U={}));class ct{constructor(t){this.cycles=0,this.maxCycles=4e7,this.trampoline=t=>(...n)=>{let r=(t=t.bind(this))(...n);for(;"function"==typeof r;)r=r();return r},this.grid=t}run(t){return this.timerStart=performance.now(),new Promise(((n,r)=>{const e=this.getFillableIndexes()[0];this.setInevitableValues(t),this.trampoline(this.updateCell)(e,U.NEXT,{progress:t,resolve:n,reject:r})}))}populateMetaDataByIndex(t,n=U.NEXT,r=!0){let e=this.grid[t];const u=i.getHorizontalNeighboursByCellIndex(this.grid,t),o=i.getVerticalNeighboursByCellIndex(this.grid,t),s=i.getSubgridNeighboursByCellIndex(this.grid,t);return n===U.PREVIOUS?e.possibleValidValues.includes(e.value)&&(e.invalidValues.push(e.value),e.possibleValidValues=st(e.possibleValidValues,e.value)):n===U.NEXT&&(e.invalidValues=[]),e=this.populateMetaDataByNeighbours(e,u),e=this.populateMetaDataByNeighbours(e,o),e=this.populateMetaDataByNeighbours(e,s),r&&(e.value=e.possibleValidValues[0]),e}setInevitableValues(t){let n=0;this.getFillableIndexes().forEach((t=>{this.grid[t]=this.populateMetaDataByIndex(t,U.NEXT,!1),1!==this.grid[t].possibleValidValues.length||this.grid[t].guaranteedValue||(this.grid[t].value=this.grid[t].possibleValidValues[0],this.grid[t].guaranteedValue=!0,this.cycles++,n++)})),t({grid:this.grid,cycles:this.cycles}),n&&this.setInevitableValues(t)}updateCell(t,n,r){if(this.cycles!==this.maxCycles){if(-1===t&&r&&r.reject("Sudoku is invalid"),this.grid[t]=this.populateMetaDataByIndex(t,n),r&&r.progress({grid:this.grid,cycles:this.cycles}),this.cycles++,-1!==this.getNextCell(t))return this.grid[t].possibleValidValues.length>0?()=>this.updateCell(this.getNextCell(t),U.NEXT,r):()=>this.updateCell(this.getPreviousCell(t),U.PREVIOUS,r);console.log("finished!"),this.timerEnd=performance.now(),console.log(`Took ${this.timerEnd-this.timerStart} milliseconds.`),r&&r.resolve(1)}}populateMetaDataByNeighbours(t,n){const r=n.filter((t=>t.value)).map((t=>t.value));return t.invalidValues=Y(t.invalidValues.concat(r)),t.possibleValidValues=st([1,2,3,4,5,6,7,8,9],...t.invalidValues),t}getNextCell(t){const n=this.getFillableIndexes(),r=n.indexOf(t);return n[r+1]||-1}getPreviousCell(t){const n=this.getFillableIndexes(),r=n.indexOf(t);return n[r-1]||-1}getFillableIndexes(){const t=[];return this.grid.forEach(((n,r)=>{n.isStaticValue||n.guaranteedValue||t.push(r)})),t}}t.solveSudoku=async(t,n)=>{const r=new ct(t);return new Promise(((t,e)=>{r.run(n).then(t).then(e)}))}})();